<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>AR Model Viewer - Follow Camera</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
      body {
        margin: 0;
        background-color: #000;
        color: white;
        font-family: sans-serif;
        overflow: hidden;
      }

      model-viewer {
        width: 100vw;
        height: 100vh;
        --poster-color: transparent;
      }

      .button-group {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 12px;
        opacity: 1;
        transition: opacity 0.4s ease;
      }

      .ar-btn,
      .link-btn {
        padding: 10px 16px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        font-size: 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        backdrop-filter: blur(8px);
        transition: background 0.3s;
      }

      .ar-btn:hover,
      .link-btn:hover {
        background: rgba(255, 255, 255, 0.3);
      }
    </style>
  </head>
  <body>
    <model-viewer
      id="mv"
      src="1M.glb"
      ios-src="1M.usdz"
      ar
      ar-modes="webxr quick-look"
      ar-scale="auto"
      ar-placement="floor"
      camera-controls
      disable-pan
      alt="BABY1M"
      exposure="1.1"
      shadow-intensity="1"
      environment-image="neutral"
    ></model-viewer>

    <div class="button-group" id="btnGroup">
      <button class="ar-btn" id="customAR">üï∂Ô∏è Xem AR</button>
      <button
        class="link-btn"
        onclick="window.open('https://store.epicgames.com/vi', '_blank')"
      >
        ‚ñ∂Ô∏è Gh√© ThƒÉm
      </button>
    </div>

    <script type="module">
      const mv = document.querySelector("#mv");
      const btnGroup = document.querySelector("#btnGroup");
      const arBtn = document.querySelector("#customAR");

      // N√∫t "Xem AR"
      arBtn.addEventListener("click", () => {
        mv.activateAR();
      });

      // Hi·ªán n√∫t sau khi model load (n·∫øu c·∫ßn)
      mv.addEventListener("load", () => {
        btnGroup.classList.add("show");
      });

      // === Model lu√¥n theo camera trong AR (WebXR - Android) ===
      mv.addEventListener("ar-status", (event) => {
        if (event.detail.status === "session-started") {
          const scene = mv.scene;
          const camera = scene.camera;
          const model = mv.model;

          // ƒê∆∞a model th√†nh con c·ªßa camera
          camera.add(model);

          // ƒê·∫∑t model ngay tr∆∞·ªõc camera 1m
          model.position.set(0, -0.2, -1); // h∆°i th·∫•p m·ªôt ch√∫t, tr√¥ng t·ª± nhi√™n h∆°n
          model.quaternion.set(0, 0, 0, 1);

          console.log("üì∏ Model attached to camera (follow mode)");
        } else if (event.detail.status === "not-presenting") {
          // Khi tho√°t AR ‚Üí tr·∫£ model v·ªÅ l·∫°i scene
          mv.scene.add(mv.model);
          console.log("üëã Model detached from camera");
        }
      });
    </script>
  </body>
</html>
